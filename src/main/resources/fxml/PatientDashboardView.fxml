<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<VBox spacing="12" stylesheets="@../css/app.css" xmlns="http://javafx.com/javafx/17.0.12" xmlns:fx="http://javafx.com/fxml/1" fx:controller="it.univr.diabete.controller.PatientDashboardController">

    <!-- Header -->
    <VBox spacing="4">
        <HBox alignment="CENTER_LEFT" spacing="6">
            <Label styleClass="page-title" text="Benvenuto" />
            <Label fx:id="patientNameLabel" styleClass="page-title-accent" text="Nome" />
        </HBox>
        <Label styleClass="page-subtitle" text="Qui puoi controllare la glicemia, la terapia e comunicare con il tuo diabetologo." visible="false" wrapText="true" />
    </VBox>

    <!-- Azioni rapide -->
    <HBox spacing="10">
        <Button fx:id="addGlycemiaButton" onAction="#handleAddGlicemia" styleClass="quick-action" text="Registra glicemia" />
        <Button fx:id="therapyButton" onAction="#handleOpenTerapia" styleClass="quick-action" text="Vedi terapia" />
        <Button fx:id="messageDoctorButton" styleClass="quick-action" text="Scrivi al diabetologo" />
    </HBox>

    <!-- Main layout -->
    <HBox spacing="16" VBox.vgrow="ALWAYS">
        <!-- Colonna sinistra: oggi + ultime misurazioni -->
        <VBox spacing="12" HBox.hgrow="ALWAYS">
            <!-- Oggi -->
            <BorderPane styleClass="card">
                <top>
                    <HBox alignment="CENTER_LEFT" spacing="8" styleClass="card-header">
                        <Label styleClass="card-title" text="Oggi" />
                        <Pane HBox.hgrow="ALWAYS" />
                        <Label fx:id="todayDateLabel" styleClass="card-subtitle" text="26 Nov 2025" />
                    </HBox>
                </top>
                <center>
                    <VBox spacing="6">
                        <padding>
                            <Insets bottom="10" left="10" right="10" top="10" />
                        </padding>
                        <CheckBox fx:id="chkMattino" text="Misura glicemia del mattino" />
                        <CheckBox fx:id="chkPranzo" text="Misura glicemia del pomeriggio" />
                        <CheckBox fx:id="chkCena" text="Misura glicemia della sera" />
                        <CheckBox fx:id="chkTerapiaAssunta" text="Terapia assunta" />
                    </VBox>
                </center>
            </BorderPane>

            <!-- Ultime misurazioni -->
            <BorderPane styleClass="card">
                <top>
                    <HBox alignment="CENTER_LEFT" spacing="8" styleClass="card-header">
                        <Label styleClass="card-title" text="Ultime misurazioni" />
                        <Pane HBox.hgrow="ALWAYS" />
                        <Button fx:id="addGlycemiaButton2" onAction="#handleAddGlicemia" styleClass="btn-ghost" text="Registra glicemia" />
                        <ChoiceBox fx:id="measurementFilter" onAction="#handleMeasurementFilterChange" styleClass="btn-ghost" />
                    </HBox>
                </top>
                <center>
                    <TableView fx:id="measurementsTable" prefHeight="220" styleClass="table-card">
                        <columns>
                            <TableColumn fx:id="colMeasDate" prefWidth="150" text="Data e ora" />
                            <TableColumn fx:id="colMeasValue" prefWidth="120" text="Valore (mg/dL)" />
                            <TableColumn fx:id="colDashMoment" prefWidth="120" text="Momento" />
                        </columns>
                    </TableView>
                </center>
            </BorderPane>
        </VBox>

        <!-- Colonna destra: sintomi -->
        <VBox prefWidth="360" spacing="12">
            <BorderPane maxHeight="270" prefHeight="270" styleClass="card">
                <top>
                    <HBox alignment="CENTER_LEFT" spacing="8" styleClass="card-header">
                        <Label styleClass="card-title" text="Sintomi di oggi" />
                        <Pane HBox.hgrow="ALWAYS" />
                        <Button fx:id="addSymptomButton" onAction="#handleAddSymptom" styleClass="btn-ghost" text="+ Aggiungi sintomo" />
                    </HBox>
                </top>
                <center>
                    <HBox spacing="12" style="-fx-padding: 12;">
                        <ListView fx:id="todaySymptomsListView" styleClass="symptom-list" HBox.hgrow="ALWAYS" />
                    </HBox>
                </center>
            </BorderPane>
        </VBox>
    </HBox>
</VBox>
