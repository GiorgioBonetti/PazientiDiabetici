<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<VBox fx:id="therapyRoot"
      xmlns="http://javafx.com/javafx/21"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="it.univr.diabete.controller.PatientTherapyController"
      spacing="16"
      style="-fx-padding: 8 16 16 16;">

    <children>

        <!-- HEADER -->
        <VBox spacing="4">
            <children>
                <HBox spacing="8" alignment="CENTER_LEFT">
                    <children>
                        <Label text="Terapia"
                               styleClass="page-title"/>
                        <Label fx:id="patientNameLabel"
                               text="Luigi Bianchi"
                               styleClass="page-title-accent"/>
                    </children>
                </HBox>
                <HBox spacing="12" alignment="CENTER_LEFT">
                <Label text="Qui trovi tutte le terapie assegnate e puoi registrare le assunzioni."
                       wrapText="true"
                       styleClass="page-subtitle"/>
                    <Button fx:id="addTherapyButton"
                            text="+"
                            onAction="#handleAddTherapy"
                            styleClass="btn-primary"/>
                    <Pane HBox.hgrow="ALWAYS"/>
                <Button fx:id="goMeasurementsButton"
                        text="Misurazioni"
                        onAction="#handleGoToMeasurements"
                        style="-fx-font-size: 12px"
                        prefWidth="150"
                        styleClass="btn-ghost"/>

                <Button fx:id="goReportButton"
                        text="Report"
                        prefWidth="150"
                        style="-fx-font-size: 12px"
                        onAction="#handleGoToReport"
                        styleClass="btn-ghost"/>
                </HBox>
            </children>
        </VBox>

        <!-- SCROLL ORIZZONTALE CON LE CARD TERAPIE -->
        <ScrollPane hbarPolicy="ALWAYS"
                    vbarPolicy="NEVER"
                    fitToHeight="true"
                    prefHeight="260"
                    style="-fx-padding: 0; -fx-background-color: transparent;">
            <content>
                <HBox fx:id="therapyCardsContainer"
                      spacing="12"
                      alignment="CENTER_LEFT"
                      style="-fx-padding: 4 0 4 0;"/>
            </content>
        </ScrollPane>

        <!-- CARD DETTAGLIO TERAPIA + ASSUNZIONI -->
        <BorderPane styleClass="card">

            <top>
                <VBox spacing="8" style="-fx-padding: 12 16 8 16;">
                    <children>
                        <Label text="Dettaglio terapia selezionata"
                               styleClass="card-title"/>

                        <ScrollPane fx:id="farmaciScroll"
                                    hbarPolicy="AS_NEEDED"
                                    vbarPolicy="NEVER"
                                    fitToHeight="true"
                                    styleClass="chip-scroll">
                            <content>
                                <HBox fx:id="farmaciCardsContainer"
                                      spacing="12"
                                      style="-fx-padding: 8 8 8 8;"/>
                            </content>
                        </ScrollPane>

                        <HBox alignment="CENTER_RIGHT" spacing="10">
                            <children>
                                <Pane HBox.hgrow="ALWAYS"/>
                                <ChoiceBox fx:id="assunzioniFilter"
                                           styleClass="btn-ghost"/>
                                <Button fx:id="addAssunzioneButton"
                                        text="Registra assunzione"
                                        styleClass="btn-primary"
                                        onAction="#handleAddAssunzione"/>
                            </children>
                        </HBox>
                    </children>
                </VBox>
            </top>


            <center>
                <VBox spacing="4" style="-fx-padding: 0 16 16 16;">
                    <children>
                        <Label text="Assunzioni registrate"
                               styleClass="card-subtitle"/>

                        <TableView fx:id="assunzioniTable"
                                   prefHeight="220"
                                   styleClass="rounded-table">
                            <columns>
                                <TableColumn fx:id="colData"
                                             text="Data / ora"
                                             prefWidth="200"/>
                                <TableColumn fx:id="colQuantita"
                                             text="QuantitÃ "
                                             prefWidth="120"/>
                            </columns>
                        </TableView>
                    </children>
                </VBox>
            </center>

        </BorderPane>

    </children>
</VBox>