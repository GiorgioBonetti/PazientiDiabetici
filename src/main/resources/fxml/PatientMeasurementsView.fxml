<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<VBox xmlns="http://javafx.com/javafx/21"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="it.univr.diabete.controller.PatientMeasurementsController"
      spacing="16"
      style="-fx-padding: 8 16 16 16;">

    <children>

        <!-- HEADER -->
        <VBox spacing="4">
            <children>
                <HBox spacing="8" alignment="CENTER_LEFT">
                    <children>
                        <Label text="Misurazioni"
                               styleClass="page-title"/>
                        <Label fx:id="patientNameLabel"
                               text="Luigi Bianchi"
                               styleClass="page-title-accent"/>
                    </children>
                </HBox>
                <!-- Bottoni di navigazione -->
                <HBox spacing="12" alignment="CENTER_LEFT">
                    <Label text="Qui puoi vedere lo storico delle tue misurazioni glicemiche."
                           wrapText="true"
                           styleClass="page-subtitle"/>
                    <Pane HBox.hgrow="ALWAYS"/>
                    <Button fx:id="goReportButton"
                            text="Report"
                            onAction="#handleGoToReport"
                            style="-fx-font-size: 12px"
                            prefWidth="150"
                            styleClass="btn-ghost"/>

                    <Button fx:id="goTherapyButton"
                            text="Terapia"
                            prefWidth="150"
                            style="-fx-font-size: 12px"
                            onAction="#handleGoToTherapy"
                            styleClass="btn-ghost"/>
                </HBox>

            </children>
        </VBox>

        <!-- CARD STORICO MISURAZIONI (piÃ¹ stretta a sinistra) -->
        <HBox alignment="CENTER_LEFT" VBox.vgrow="NEVER"
              spacing="0">
        <BorderPane styleClass="card"
        prefHeight="200"
        prefWidth="470">
            <top>
                <HBox spacing="8"
                      alignment="CENTER_LEFT"
                      styleClass="card-header">
                    <children>
                        <Label text="Ultime misurazioni" styleClass="card-title"/>
                        <Pane HBox.hgrow="ALWAYS"/>
                        <Button fx:id="addGlycemiaButton"
                                text="Registra glicemia"
                                onAction="#handleAddGlicemia"
                                styleClass="btn-ghost"/>
                        <ComboBox fx:id="filterCombo" styleClass="btn-ghost"/>
                    </children>
                </HBox>
            </top>
            <center>
                <TableView fx:id="measurementsTable" prefHeight="220">
                    <columns>
                        <TableColumn fx:id="colMeasDateTime" text="Data e ora" prefWidth="150"/>
                        <TableColumn fx:id="colMeasValue" text="Valore (mg/dL)" prefWidth="160"/>
                        <TableColumn fx:id="colMeasMoment" text="Momento" prefWidth="100"/>
                    </columns>
                </TableView>
            </center>
        </BorderPane>
        </HBox>
        <!-- CARD GRAFICO ANDAMENTO (full width) -->
        <BorderPane styleClass="card"
                    VBox.vgrow="ALWAYS">
            <top>
                <HBox spacing="8"
                      alignment="CENTER_LEFT"
                      styleClass="card-header">
                    <children>
                        <Label text="Andamento glicemia"
                               styleClass="card-title"/>
                        <Pane HBox.hgrow="ALWAYS"/>
                    </children>
                </HBox>
            </top>

            <center>
                <LineChart fx:id="glycemiaChart"
                           animated="false"
                           legendVisible="false"
                           prefHeight="260">
                    <xAxis>
                        <CategoryAxis fx:id="xAxis" label="Data / ora"/>
                    </xAxis>
                    <yAxis>
                        <NumberAxis fx:id="yAxis" label="Valore (mg/dL)"/>
                    </yAxis>
                </LineChart>
            </center>
        </BorderPane>

    </children>
</VBox>